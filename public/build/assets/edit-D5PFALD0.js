import{r as c,u as Q,b as $,j as e,H as X,L as g,a as Y}from"./app-m4SEsFiE.js";import{A as Z,I as ee}from"./app-layout-BumpU3EB.js";import{B as p}from"./button-B-WEzdAj.js";import{I as d}from"./input-5V3zXozb.js";import{L as l}from"./label-KmRgxdzX.js";import{T as j}from"./textarea-VzZyahIs.js";import{C as o,a as m,b as x,c as h}from"./card-DAZkrJCd.js";import{S as u,a as v,b as N,c as f,d as y}from"./select-Bucetb1j.js";import{C as B}from"./checkbox-BcpP1FIe.js";import{T as se}from"./time-range-picker-Bf0dvUz-.js";import{T as U,a as I,b as k,c as S}from"./tabs-CEAETiSQ.js";import{I as z}from"./image-upload-Bl86N5Wu.js";import{g as H,S as w}from"./dropdown-menu-BE1c-vsa.js";import{G as ae}from"./globe-CrBjwrOr.js";import{M as te}from"./map-pin-BAgRtuu2.js";import{P as M}from"./plus-CnyTP5s-.js";import{S as ie}from"./square-pen-DmLpV6cU.js";/* empty css            */import"./index-89Llf8Yk.js";import"./index-D61C-zyG.js";import"./index-9BWeTyv_.js";import"./index-D5fK6wwI.js";import"./collapsible-CJSf55eg.js";import"./chevron-right-BHx-thNb.js";import"./app-logo-icon-BvgPms2S.js";import"./use-business-settings-z5aa--sV.js";import"./building-CDBhthyV.js";import"./users-CCvNB95W.js";import"./shield-BLMtoxU7.js";import"./avatar-7NHQ17s9.js";import"./index-CXFdqqwl.js";import"./chevron-up-DZ2i7E5U.js";import"./check-Cd4UBeWr.js";import"./index-BMjyTS6w.js";import"./upload-CVCRsBzD.js";function He({auth:re,business:t,provinces:R}){const[C,F]=c.useState([]),[E,b]=c.useState([]),[W,_]=c.useState([]),[L,V]=c.useState("en"),{data:i,setData:r,put:ne,processing:O,errors:a}=Q({name:t.name||"",descriptions:t.descriptions||"",name_translations:t.name_translations||{en:t.name||"",km:""},descriptions_translations:t.descriptions_translations||{en:t.descriptions||"",km:""},province_id:t.province_id?.toString()||"",district_id:t.district_id?.toString()||"",commune_id:t.commune_id?.toString()||"",village_id:t.village_id?.toString()||"",latitude:t.latitude||"",longitude:t.longitude||"",opening_time:t.opening_time||"",closing_time:t.closing_time||"",status:t.status??!1,is_vierify:t.is_vierify??!1,seo_title:t.seo_title||"",seo_description:t.seo_description||"",seo_title_translations:t.seo_title_translations||{en:t.seo_title||"",km:""},seo_description_translations:t.seo_description_translations||{en:t.seo_description||"",km:""},seo_image:t.seo_image?t.seo_image.startsWith("http")||t.seo_image.startsWith("/")?t.seo_image:H(t.seo_image,"businesses"):"",seo_keywords:t.seo_keywords||[],image:t.image?H(t.image,"businesses"):null});c.useEffect(()=>{t.province_id&&A(t.province_id.toString())},[]),c.useEffect(()=>{t.district_id&&C.length>0&&D(t.district_id.toString())},[C]),c.useEffect(()=>{t.commune_id&&E.length>0&&P(t.commune_id.toString())},[E]);const A=async s=>{if(s)try{const n=await $.get(`/api/districts/${s}`);F(n.data)}catch(n){console.error("Error fetching districts:",n)}},D=async s=>{if(s)try{const n=await $.get(`/api/communes/${s}`);b(n.data)}catch(n){console.error("Error fetching communes:",n)}},P=async s=>{if(s)try{const n=await $.get(`/api/villages/${s}`);_(n.data)}catch(n){console.error("Error fetching villages:",n)}},G=async s=>{r("province_id",s),r("district_id",""),r("commune_id",""),r("village_id",""),F([]),b([]),_([]),await A(s)},q=async s=>{r("district_id",s),r("commune_id",""),r("village_id",""),b([]),_([]),await D(s)},K=async s=>{r("commune_id",s),r("village_id",""),_([]),await P(s)},J=s=>{s.preventDefault();const n={...i};n._method="PUT",Y.post(`/admin/businesses/${t.id}`,n)};return e.jsxs(Z,{children:[e.jsx(X,{title:`Edit ${t.name}`}),e.jsx("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4 overflow-x-auto",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Edit Business"}),e.jsx("p",{className:"text-gray-600",children:t.name})]})})}),e.jsx("form",{onSubmit:J,className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(o,{children:[e.jsx(m,{children:e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"w-5 h-5"}),"Business Information"]})}),e.jsxs(h,{className:"space-y-6",children:[e.jsxs(U,{value:L,onValueChange:s=>V(s),children:[e.jsxs(I,{className:"grid w-full grid-cols-2 mb-6 max-w-md",children:[e.jsxs(k,{value:"en",className:"flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ‡ºðŸ‡¸"}),e.jsx("span",{children:"English"})]}),e.jsxs(k,{value:"km",className:"flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ‡°ðŸ‡­"}),e.jsx("span",{children:"ážáŸ’áž˜áŸ‚ážš"})]})]}),e.jsxs(S,{value:"en",className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"name_en",children:"Business Name (English) *"}),e.jsx(d,{id:"name_en",type:"text",value:i.name_translations?.en||"",onChange:s=>{const n=s.target.value;r("name_translations",{...i.name_translations,en:n}),r("name",n)},placeholder:"e.g., Phnom Penh Tire Center",className:`max-w-2xl ${a["name_translations.en"]||a.name?"border-red-500":""}`}),(a["name_translations.en"]||a.name)&&e.jsx("p",{className:"text-sm text-red-500",children:a["name_translations.en"]||a.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"descriptions_en",children:"Business Description (English)"}),e.jsx(j,{id:"descriptions_en",value:i.descriptions_translations?.en||"",onChange:s=>{const n=s.target.value;r("descriptions_translations",{...i.descriptions_translations,en:n}),r("descriptions",n)},placeholder:"Tell customers about the tire shop, services, and specialties...",rows:3,className:`max-w-2xl ${a["descriptions_translations.en"]||a.descriptions?"border-red-500":""}`}),(a["descriptions_translations.en"]||a.descriptions)&&e.jsx("p",{className:"text-sm text-red-500",children:a["descriptions_translations.en"]||a.descriptions})]})]}),e.jsxs(S,{value:"km",className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"name_km",children:"ážˆáŸ’áž˜áŸ„áŸ‡áž¢áž¶áž‡áž¸ážœáž€áž˜áŸ’áž˜ (ážáŸ’áž˜áŸ‚ážš)"}),e.jsx(d,{id:"name_km",type:"text",value:i.name_translations?.km||"",onChange:s=>{r("name_translations",{...i.name_translations,km:s.target.value})},placeholder:"áž§. áž áž¶áž„áž€áž„áŸ‹áž—áŸ’áž“áŸ†áž–áŸáž‰",className:`max-w-2xl ${a["name_translations.km"]?"border-red-500":""}`}),a["name_translations.km"]&&e.jsx("p",{className:"text-sm text-red-500",children:a["name_translations.km"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"descriptions_km",children:"áž€áž¶ážšáž–áž·áž–ážŽáŸŒáž“áž¶áž¢áž¶áž‡áž¸ážœáž€áž˜áŸ’áž˜ (ážáŸ’áž˜áŸ‚ážš)"}),e.jsx(j,{id:"descriptions_km",value:i.descriptions_translations?.km||"",onChange:s=>{r("descriptions_translations",{...i.descriptions_translations,km:s.target.value})},placeholder:"áž”áŸ’ážšáž¶áž”áŸ‹áž¢ážáž·ážáž·áž‡áž“áž¢áŸ†áž–áž¸áž áž¶áž„áž€áž„áŸ‹ ážŸáŸážœáž¶áž€áž˜áŸ’áž˜ áž“áž·áž„áž‡áŸ†áž“áž¶áž‰...",rows:3,className:`max-w-2xl ${a["descriptions_translations.km"]?"border-red-500":""}`}),a["descriptions_translations.km"]&&e.jsx("p",{className:"text-sm text-red-500",children:a["descriptions_translations.km"]})]})]})]}),e.jsxs("div",{className:"space-y-2 pt-4 border-t",children:[e.jsx(l,{children:"Business Hours"}),e.jsx(se,{startTime:i.opening_time,endTime:i.closing_time,onStartTimeChange:s=>r("opening_time",s),onEndTimeChange:s=>r("closing_time",s),startError:a.opening_time,endError:a.closing_time})]})]})]}),e.jsxs(o,{children:[e.jsx(m,{children:e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(te,{className:"w-5 h-5"}),"Location Details"]})}),e.jsxs(h,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Province *"}),e.jsxs(u,{value:i.province_id,onValueChange:G,children:[e.jsx(v,{className:a.province_id?"border-red-500":"",children:e.jsx(N,{placeholder:"Select Province"})}),e.jsx(f,{children:R.map(s=>e.jsx(y,{value:s.id.toString(),children:s.name},s.id))})]}),a.province_id&&e.jsx("p",{className:"text-sm text-red-500",children:a.province_id})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"District *"}),e.jsxs(u,{value:i.district_id,onValueChange:q,disabled:!i.province_id,children:[e.jsx(v,{className:a.district_id?"border-red-500":"",children:e.jsx(N,{placeholder:"Select District"})}),e.jsx(f,{children:C.map(s=>e.jsx(y,{value:s.id.toString(),children:s.name},s.id))})]}),a.district_id&&e.jsx("p",{className:"text-sm text-red-500",children:a.district_id})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Commune"}),e.jsxs(u,{value:i.commune_id,onValueChange:K,disabled:!i.district_id,children:[e.jsx(v,{className:a.commune_id?"border-red-500":"",children:e.jsx(N,{placeholder:"Select Commune"})}),e.jsx(f,{children:E.map(s=>e.jsx(y,{value:s.id.toString(),children:s.name},s.id))})]}),a.commune_id&&e.jsx("p",{className:"text-sm text-red-500",children:a.commune_id})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Village"}),e.jsxs(u,{value:i.village_id,onValueChange:s=>r("village_id",s),disabled:!i.commune_id,children:[e.jsx(v,{className:a.village_id?"border-red-500":"",children:e.jsx(N,{placeholder:"Select Village"})}),e.jsx(f,{children:W.map(s=>e.jsx(y,{value:s.id.toString(),children:s.name},s.id))})]}),a.village_id&&e.jsx("p",{className:"text-sm text-red-500",children:a.village_id})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"latitude",children:"Latitude"}),e.jsx(d,{id:"latitude",type:"text",value:i.latitude,onChange:s=>r("latitude",s.target.value),placeholder:"11.5564",className:a.latitude?"border-red-500":""}),a.latitude&&e.jsx("p",{className:"text-sm text-red-500",children:a.latitude})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"longitude",children:"Longitude"}),e.jsx(d,{id:"longitude",type:"text",value:i.longitude,onChange:s=>r("longitude",s.target.value),placeholder:"104.9282",className:a.longitude?"border-red-500":""}),a.longitude&&e.jsx("p",{className:"text-sm text-red-500",children:a.longitude})]})]})]})]}),e.jsxs(o,{children:[e.jsx(m,{children:e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(w,{className:"w-5 h-5"}),"SEO Settings"]})}),e.jsxs(h,{className:"space-y-6",children:[e.jsxs(U,{value:L,onValueChange:s=>V(s),children:[e.jsxs(I,{className:"grid w-full grid-cols-2 mb-6 max-w-md",children:[e.jsxs(k,{value:"en",className:"flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ‡ºðŸ‡¸"}),e.jsx("span",{children:"English"})]}),e.jsxs(k,{value:"km",className:"flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ‡°ðŸ‡­"}),e.jsx("span",{children:"ážáŸ’áž˜áŸ‚ážš"})]})]}),e.jsxs(S,{value:"en",className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"seo_title_en",children:"SEO Title (English)"}),e.jsx(d,{id:"seo_title_en",type:"text",value:i.seo_title_translations?.en||"",onChange:s=>{const n=s.target.value;r("seo_title_translations",{...i.seo_title_translations,en:n}),r("seo_title",n)},placeholder:"SEO title for search engines",className:`max-w-2xl ${a["seo_title_translations.en"]||a.seo_title?"border-red-500":""}`}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[(i.seo_title_translations?.en||"").length,"/60 characters",(i.seo_title_translations?.en||"").length>60&&e.jsx("span",{className:"text-amber-600 ml-2",children:"May be truncated in search results"})]}),(a["seo_title_translations.en"]||a.seo_title)&&e.jsx("p",{className:"text-sm text-red-500",children:a["seo_title_translations.en"]||a.seo_title})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"seo_description_en",children:"SEO Description (English)"}),e.jsx(j,{id:"seo_description_en",value:i.seo_description_translations?.en||"",onChange:s=>{const n=s.target.value;r("seo_description_translations",{...i.seo_description_translations,en:n}),r("seo_description",n)},placeholder:"SEO description for search engines (150-160 characters recommended)",rows:3,className:`max-w-2xl ${a["seo_description_translations.en"]||a.seo_description?"border-red-500":""}`}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[(i.seo_description_translations?.en||"").length,"/160 characters",(i.seo_description_translations?.en||"").length>160&&e.jsx("span",{className:"text-amber-600 ml-2",children:"May be truncated in search results"})]}),(a["seo_description_translations.en"]||a.seo_description)&&e.jsx("p",{className:"text-sm text-red-500",children:a["seo_description_translations.en"]||a.seo_description})]})]}),e.jsxs(S,{value:"km",className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"seo_title_km",children:"áž…áŸ†ážŽáž„áž‡áž¾áž„ SEO (ážáŸ’áž˜áŸ‚ážš)"}),e.jsx(d,{id:"seo_title_km",type:"text",value:i.seo_title_translations?.km||"",onChange:s=>{r("seo_title_translations",{...i.seo_title_translations,km:s.target.value})},placeholder:"áž…áŸ†ážŽáž„áž‡áž¾áž„ SEO ážŸáž˜áŸ’ážšáž¶áž”áŸ‹áž˜áŸ‰áž¶ážŸáŸŠáž¸áž“ážŸáŸ’ážœáŸ‚áž„ážšáž€",className:`max-w-2xl ${a["seo_title_translations.km"]?"border-red-500":""}`}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[(i.seo_title_translations?.km||"").length,"/60 ážáž½áž¢áž€áŸ’ážŸážš"]}),a["seo_title_translations.km"]&&e.jsx("p",{className:"text-sm text-red-500",children:a["seo_title_translations.km"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"seo_description_km",children:"áž€áž¶ážšáž–áž·áž–ážŽáŸŒáž“áž¶ SEO (ážáŸ’áž˜áŸ‚ážš)"}),e.jsx(j,{id:"seo_description_km",value:i.seo_description_translations?.km||"",onChange:s=>{r("seo_description_translations",{...i.seo_description_translations,km:s.target.value})},placeholder:"áž€áž¶ážšáž–áž·áž–ážŽáŸŒáž“áž¶ SEO ážŸáž˜áŸ’ážšáž¶áž”áŸ‹áž˜áŸ‰áž¶ážŸáŸŠáž¸áž“ážŸáŸ’ážœáŸ‚áž„ážšáž€",rows:3,className:`max-w-2xl ${a["seo_description_translations.km"]?"border-red-500":""}`}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[(i.seo_description_translations?.km||"").length,"/160 ážáž½áž¢áž€áŸ’ážŸážš"]}),a["seo_description_translations.km"]&&e.jsx("p",{className:"text-sm text-red-500",children:a["seo_description_translations.km"]})]})]})]}),e.jsx("div",{className:"space-y-4 pt-4 border-t",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"space-y-2",children:e.jsx(z,{label:"SEO Image",value:i.seo_image,onChange:(s,n)=>{s?r("seo_image",s):n?r("seo_image",n):r("seo_image","")},error:a.seo_image,placeholder:"Upload SEO image or enter URL (1200x630 recommended)",maxSize:10})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"seo_keywords",children:"SEO Keywords (comma-separated)"}),e.jsx(d,{id:"seo_keywords",type:"text",value:i.seo_keywords.join(", "),onChange:s=>{const n=s.target.value.split(",").map(T=>T.trim()).filter(T=>T.length>0);r("seo_keywords",n)},placeholder:"tire, car, automotive, repair, service",className:`max-w-2xl ${a.seo_keywords?"border-red-500":""}`}),a.seo_keywords&&e.jsx("p",{className:"text-sm text-red-500",children:a.seo_keywords})]})]})})]})]}),e.jsxs(o,{children:[e.jsx(m,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(w,{className:"w-5 h-5"}),"Services (",t.services?.length||0,")"]}),e.jsx(g,{href:route("admin.services.create",t.id),children:e.jsxs(p,{type:"button",size:"sm",children:[e.jsx(M,{className:"w-4 h-4 mr-1"}),"Add Service"]})})]})}),e.jsx(h,{children:t.services&&t.services.length>0?e.jsx("div",{className:"space-y-3",children:t.services.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:s.name}),s.description&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s.description}),s.price&&e.jsxs("p",{className:"text-sm font-medium text-green-600 mt-1",children:["$",s.price]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(g,{href:route("admin.services.edit",s.id),children:e.jsx(p,{type:"button",size:"sm",variant:"outline",children:e.jsx(ie,{className:"w-3 h-3"})})})})]},s.id))}):e.jsxs("div",{className:"text-center py-6",children:[e.jsx(w,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-1",children:"No services added yet"}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Add services to this business."}),e.jsx(g,{href:route("admin.services.create",t.id),children:e.jsxs(p,{type:"button",size:"sm",children:[e.jsx(M,{className:"w-4 h-4 mr-1"}),"Add First Service"]})})]})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(o,{children:[e.jsx(m,{children:e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(w,{className:"w-5 h-5"}),"Status Settings"]})}),e.jsxs(h,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(B,{id:"status",checked:i.status,onCheckedChange:s=>r("status",s)}),e.jsx(l,{htmlFor:"status",className:"text-sm font-medium",children:"Active Status"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(B,{id:"is_vierify",checked:i.is_vierify,onCheckedChange:s=>r("is_vierify",s)}),e.jsx(l,{htmlFor:"is_vierify",className:"text-sm font-medium",children:"Verified by Admin"})]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:[e.jsx("p",{children:"â€¢ Active Status: Whether the business is currently operational"}),e.jsx("p",{children:"â€¢ Verified: Admin approval to show on the public website"})]})]})]}),e.jsxs(o,{children:[e.jsx(m,{children:e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"w-5 h-5"}),"Business Image"]})}),e.jsx(h,{children:e.jsx(z,{label:"",value:i.image,onChange:(s,n)=>{s?r("image",s):n?r("image",n):r("image",null)},error:a.image,placeholder:"Upload business image or enter URL"})})]}),e.jsxs(o,{children:[e.jsx(m,{children:e.jsx(x,{children:"Actions"})}),e.jsxs(h,{className:"space-y-3",children:[e.jsx(p,{type:"submit",disabled:O,className:"w-full",children:O?"Saving...":"Save Changes"}),e.jsx(g,{href:`/admin/businesses/${t.id}`,children:e.jsx(p,{variant:"outline",className:"w-full",children:"Cancel"})})]})]})]})]})})]})})]})}export{He as default};
